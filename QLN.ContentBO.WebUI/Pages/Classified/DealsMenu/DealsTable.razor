@inherits DealsTableBase
@using QLN.ContentBO.WebUI.Components.ToggleTabs
@using MudBlazor
@using QLN.ContentBO.WebUI.Components.PaginationFooter

<MudPaper Class="pa-4">
    <ToggleTabs Options="@tabOptions"
                ActiveValue="@selectedTab"
                OnChange="@OnTabChanged" />

    <div class="tab-content">
        @if (SelectedListings.Count > 0)
        {
            <div class="action-buttons">
                @if (selectedTab == "pendingApproval")
                {
                    <MudButton Class="capitalize-button" Color="Color.Success" Variant="Variant.Filled" StartIcon="@Icons.Material.Filled.Check"
                               OnClick='() => ShowConfirmation("Approve Items", "Are you sure you want to approve selected Items?", "Approve", ApproveSelected)'>
                        Approve
                    </MudButton>
                }
                else if (selectedTab == "published")
                {
                    <MudButton Class="capitalize-button" Color="Color.Primary" Variant="Variant.Filled" StartIcon="@Icons.Material.Outlined.VisibilityOff"
                               OnClick='() => ShowConfirmation("Unpublish Items", "Are you sure you want to unpublish selected Items?", "Unpublish", UnpublishSelected)'>
                        Unpublish
                    </MudButton>
                    <MudButton Class="capitalize-button" Color="Color.Error" Variant="Variant.Filled" StartIcon="@Icons.Material.Rounded.Close"
                               OnClick='() => ShowConfirmation("Remove Items", "Are you sure you want to remove selected Items?", "Remove", RemoveSelected)'>
                        Remove
                    </MudButton>
                }
                else if (selectedTab == "unpublished")
                {
                    <MudButton Class="capitalize-button" Color="Color.Primary" Variant="Variant.Filled" StartIcon="@Icons.Material.Outlined.RemoveRedEye"
                               OnClick='() => ShowConfirmation("Publish Items", "Are you sure you want to publish selected Items?", "Publish", PublishSelected)'>
                        Publish
                    </MudButton>
                    <MudButton Class="capitalize-button" Color="Color.Error" Variant="Variant.Filled" StartIcon="@Icons.Material.Rounded.Close"
                               OnClick='() => ShowConfirmation("Remove Items", "Are you sure you want to remove selected Items?", "Remove", RemoveSelected)'>
                        Remove
                    </MudButton>
                }

                @if (selectedTab == "promoted")
                {
                    <MudButton Class="capitalize-button" Color="Color.Primary" Variant="Variant.Filled"
                               OnClick='() => ShowConfirmation("Unpromote Items", "Are you sure you want to unpromote selected Items?", "Unpromote", UnpromoteSelected)'>
                        Unpromote
                    </MudButton>
                }

                @if (selectedTab == "featured")
                {
                    <MudButton Class="capitalize-button" Color="Color.Primary" Variant="Variant.Filled"
                               OnClick='() => ShowConfirmation("Unfeature Items", "Are you sure you want to unfeature selected Items?", "Unfeature", UnfeatureSelected)'>
                        Unfeature
                    </MudButton>
                }

                @if (selectedTab == "p2p" || selectedTab == "promoted" || selectedTab == "featured")
                {
                    <MudButton Class="capitalize-button" Color="Color.Error" Variant="Variant.Filled" StartIcon="@Icons.Material.Rounded.Close"
                               OnClick='() => ShowConfirmation("Remove Items", "Are you sure you want to remove selected Items?", "Remove", RemoveSelected)'>
                        Remove
                    </MudButton>
                }
            </div>

            <div class="alert-container">
                <MudIcon Icon="@Icons.Material.Filled.CheckCircle" Color="Color.Primary" />
                @($"{SelectedListings.Count} item(s) selected.")
            </div>
        }
    </div>

    <MudTable Items="Listings"
              Hover="true"
              Bordered="true"
              Elevation="0"
              MultiSelection="true"
              RowCheckBoxVisible="true"
              @bind-SelectedItems="SelectedListings"
              Class="mud-table event-custom-table">

        <HeaderContent>
            <MudTh class="header-cell">Ad ID</MudTh>
            <MudTh class="header-cell">Deals Title</MudTh>
            <MudTh class="header-cell">Subscription Type</MudTh>
            <MudTh class="header-cell">Location</MudTh>
            <MudTh class="header-cell">Creation Date</MudTh>
            <MudTh class="header-cell">Start Date</MudTh>
            <MudTh class="header-cell">Expiry Date</MudTh>
            <MudTh class="header-cell">Mobile</MudTh>
            <MudTh class="header-cell">Whatsapp</MudTh>
            <MudTh class="header-cell">Web URL</MudTh>
            <MudTh class="header-cell">Web Clicks</MudTh>
            <MudTh class="header-cell">Views</MudTh>
            <MudTh class="header-cell">Phone Leads</MudTh>
            <MudTh class="header-cell">Impression</MudTh>
            <MudTh class="header-cell">Actions</MudTh>

        </HeaderContent>

        <RowTemplate>
         
            <MudTd><MudLink Href="#">@context.AdId</MudLink></MudTd>
            <MudTd><MudLink Href="#">@context.AdTitle</MudLink></MudTd>
            <MudTd>12 months</MudTd>
            <MudTd>Doha</MudTd>
            <MudTd>@context.CreationDate.ToString("dd-MM-yyyy")</MudTd>
            <MudTd>@context.PublishedDate.ToString("dd-MM-yyyy")</MudTd>
            <MudTd>@context.ExpiryDate.ToString("dd-MM-yyyy")</MudTd>
            <MudTd>123456789</MudTd>
            <MudTd>123456789</MudTd>
            <MudTd>https://www.qatarliving.com/content/daily</MudTd>
            <MudTd>12</MudTd>
            <MudTd>24</MudTd>
            <MudTd>100</MudTd>
            <MudTd>10</MudTd>

            <MudTd>
                <MudMenu Class="mud-table-menu" Icon="@Icons.Material.Filled.MoreVert" Dense="true">
                    <MudMenuItem OnClick="() => OnEdit(context)">
                                 Class="mud-text-error">
                        <img src="/qln-images/edit_dark_icon.svg" class="menu-icon-style" alt="Ignore" />
                        <span class="menu-text">Edit</span>
                    </MudMenuItem>
                  </MudMenu>
            </MudTd>
        </RowTemplate>
    </MudTable>
     <PaginationFooter TotalItems="@TotalCount" CurrentPage="@currentPage" PageSize="@pageSize"
                OnPageChange="@HandlePageChange" OnPageSizeChange="@HandlePageSizeChange" />
</MudPaper>
