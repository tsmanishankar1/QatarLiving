@page "/qln/classified/dashboard/PreLoved"
@inherits PreLovedDashboardBase
@using MudBlazor
@using QLN.Web.Shared.Components.BreadCrumb
@using QLN.Web.Shared.Components.EmptyCard
@using QLN.Web.Shared.Pages.Classifieds.Dashboards
@using QLN.Web.Shared.Components.PaginationFooter

<div>
    <MudContainer MaxWidth="MaxWidth.Large" Class="dashboard-container">
                         <ClassifiedsDashboard SelectedDashboard="DashboardType.PreLoved" />

        <div class="dashboard-header">
            <div class="dashboard-title-container">
                <MudText class="dashboard-title">
                    PreLoved Dashboard
                </MudText>
            </div>
            @if (companyProfile == null)
            {
                <div class="dashboard-button-container">
                    <MudButton Variant="Variant.Outlined" Class="font-semibold dashboard-edit-profile-button"
                               OnClick="NavigateToCreateProfile">
                        Create Profile
                    </MudButton>
                </div>
            }
        </div>

        <!-- Your dashboard content would go here -->
        <MudPaper Class="p-4 rounded-xl dashboard-statistics-container">

            @if (isCompanyLoading)
            {
                <MudProgressCircular Indeterminate="true" Size="Size.Medium" Color="Color.Primary" />
            }
            else if (companyProfile != null)
            {
                <MudPaper Class="p-4 dashboard-company-container">
                    <img src="@companyProfile.CompanyLogo" alt="Logo" class="dashboard-company-logo" />
                    <MudText Typo="Typo.h6" Class="mt-2" Style="color:#004F9A; font-weight: bold;">
                        @companyProfile.BusinessName
                    </MudText>
                    <MudText Typo="Typo.body2" Style="color: #5F6C7B;">
@string.Join(", ", companyProfile.NatureOfBusiness
    .Select(id => GetDisplayName((NatureOfBusiness)id))) - Company   </MudText>
                    <MudText Typo="Typo.caption" Class="mt-1" Style="color: #5F6C7B;">Created on</MudText>
                    <MudText Typo="Typo.caption" Style="color: #5F6C7B;">
                        @companyProfile.CreatedUtc.ToString("MMM dd, yyyy")
                    </MudText>
                    <MudButton Variant="Variant.Outlined" Class="font-semibold mt-3 dashboard-edit-profile-button"
                                         OnClick="@(() => NavigateToEditProfile(companyProfile.Id))">
                        Edit Profile
                    </MudButton>
                </MudPaper>
            }
            <!-- Summary Cards -->
            <div class="statistics-content">
                <div class="statistics-header">
                    <MudText Typo="Typo.caption" Class="dashboard-statistics-title">Summary & Statistics</MudText>

                    <div style="display: flex; align-items: center; gap: 8px; border: 1px solid #FF7F38; border-radius: 6px; padding: 8px 12px; width: fit-content;">
                        <img src="/qln-images/subscription/Download.svg" alt="Download" style="width: 24px;" />
                        <span style="font-family: 'Public Sans', sans-serif; font-weight: 500; font-size: 14px; line-height: 22px; color: #FF7F38;">
                            Download Report
                        </span>
                    </div>


                </div>

                @if (_isLoading)
                {
                    <div class="d-flex justify-content-center mt-5">
                        <MudProgressCircular Color="Color.Primary" Indeterminate="true" Size="Size.Large" />
                    </div>
                }
                else if (!string.IsNullOrEmpty(_errorMessage))
                {
                    <EmptyCard Title="Subscription statistics not found for you account " Subtitle="Please check back later for updates." />
                }
                else if (stats != null && stats.Any())
                {
                    <MudGrid Class="mt-3">
                        @foreach (var stat in stats)
                        {
                            <MudItem xs="6" sm="4" md="3" Class="stat-item">
                                <MudPaper Elevation="0" Class="p-3 d-flex align-items-center stat-paper"
                                          Style="justify-content:center;align-items:center;gap: 20px; border-radius: 12px;height:100px; background-color: #F9FAFB;">
                                    <img src="/qln-images/subscription/@stat.Icon" class="stat-icon" />
                                    <div class="stat-content">
                                        <MudText Typo="Typo.caption"
                                                 Class="stat-title">
                                            @stat.Title
                                        </MudText>
                                        <MudText Typo="Typo.subtitle2"
                                                 Class="stat-value">
                                            @stat.Value
                                        </MudText>
                                    </div>
                                </MudPaper>
                            </MudItem>
                        }
                    </MudGrid>
                
                }
                else
                {
                    <EmptyCard Title="Subscription statistics not found for you account " Subtitle="Please check back later for updates." />
                }

            </div>
        </MudPaper>

        <div class="my-ad-section">

            <!-- Left side: 20% width tabs -->
            <div class="my-ad-toolbar-section">
                <div class="tabs-toolbar">
                    <div class="tab @( _activeTabIndex == 0 ? "active" : "" )" @onclick="() => SetTab(0)">
                        <div style="display: flex; flex-direction: row; gap: 10px;">
                            <span class="dashboard-tab-text">My Ads</span>
                        </div>
                        <div class="dashboard-tab-indicator"></div>
                    </div>
                </div>
            </div>

            <!-- Right side: Post Add button -->
            <div>
                <MudButton Variant="Variant.Filled" Class="font-semibold mt-3" OnClick="@NavigateToAdPost"
                           Style="border-radius: 8px; background-color: #F26D1E; color: white; width: 200px; display: flex; align-items: center; justify-content: center; gap: 8px;text-transform:none">
                    <MudIcon Icon="@Icons.Material.Filled.Add" />
                    Post New Ad
                </MudButton>
            </div>

        </div>

        <!-- My Ads Section -->
       <!-- My Ads Section -->
        <MudPaper Class="mt-4 p-5 rounded-xl" Style="background-color: white; box-shadow: none;padding:40px">


            <!-- Tabs + Search/Sort -->
            <div class="d-flex flex-column flex-sm-row mb-4" style="border-bottom: 1px solid #EAECF0;">
                <!-- First Row (Tabs) -->
                <div class="d-flex">
                    <!-- Published Tab (active style) -->
                    <MudButton Variant="Variant.Text" Class="@(_selectedAdsTab == 0 ? "active-tab" : "")"
                               Style="text-transform: none; font-weight: 600; padding-bottom: 12px; margin-right: 24px; position: relative;"
                               @onclick="() => _selectedAdsTab = 0">
                        Published (@publishedAds.Count)
                        @if (_selectedAdsTab == 0)
                        {
                            <div style="position: absolute; bottom: -1px; left: 0; width: 100%; height: 2px; background-color: #F26D1E;">
                            </div>
                        }
                    </MudButton>
                    <!-- Unpublished Tab -->
                    <MudButton Variant="Variant.Text" Class="@(_selectedAdsTab == 1 ? "active-tab" : "")"
                               Style="text-transform: none; font-weight: 600; padding-bottom: 12px; position: relative;"
                               @onclick="() => _selectedAdsTab = 1">
                        Unpublished (@unpublishedAds.Count)
                        @if (_selectedAdsTab == 1)
                        {
                            <div style="position: absolute; bottom: -1px; left: 0; width: 100%; height: 2px; background-color: #F26D1E;">
                            </div>
                        }
                    </MudButton>
                </div>

                <!-- Second Row (Search/Sort) - will stack below tabs on mobile -->
                <div class="ml-sm-auto d-flex align-items-center mt-2 mt-sm-0">

                    <div class="search-wrapper mr-2">
                        <img src="/qln-images/subscription/Search.svg" />
                        <MudTextField T="string"
                                      Placeholder="Search"
                                      Class="no-underline"
                                      Style="margin-left: 6px; max-width: 300px;"
                                      DisableUnderLine="true" />
                    </div>

                    <!-- Sort Button with SVG Icon -->
                    <MudMenu AnchorOrigin="Origin.BottomRight"
                             TransformOrigin="Origin.TopRight"
                             OffsetY="true">
                        <ActivatorContent>
                            <MudButton Variant="Variant.Text"
                                       Style="text-transform: none; color: #344054; display: flex; align-items: center; gap: 8px;margin-right:4px">
                                <img src="/qln-images/subscription/Sort.svg" style="width: 18px; height: 18px;" />
                                Sort
                            </MudButton>
                        </ActivatorContent>
                        <ChildContent>
                            <MudMenuItem>Default</MudMenuItem>
                            <MudMenuItem>Creation Date: Oldest</MudMenuItem>
                            <MudMenuItem>Creation Date: Recent</MudMenuItem>
                            <MudMenuItem>Expiry Date: Recent</MudMenuItem>
                            <MudMenuItem>Expiry Date: Oldest</MudMenuItem>
                            <MudMenuItem>Add-on Expiry Date: Oldest</MudMenuItem>
                            <MudMenuItem>Add-on Expiry Date: Recent</MudMenuItem>
                            <MudMenuItem>Price: High to Low</MudMenuItem>
                            <MudMenuItem>Price: Low to High</MudMenuItem>
                        </ChildContent>
                    </MudMenu>
                </div>
            </div>
            @if (_selectedAdsTab == 0)
            {
                @if (_isPublishedLoading)
                {
                    <div class="d-flex justify-content-center mt-4 mb-4">
                        <MudProgressCircular Color="Color.Primary" Indeterminate="true" Size="Size.Medium" />
                    </div>
                }
                else if (publishedAds != null && publishedAds.Any())
                {

                    <!-- Published Ads -->
                    @foreach (var ad in publishedAds)
                    {
                        <MudPaper Class="ad-container d-flex flex-column flex-sm-row mt-4 "
                                  Style="border-radius: 0; border: none; border-bottom: 1px solid #EAECF0; box-shadow: none;">
                            <!-- First Row (Image + Checkbox) - full width on mobile -->
                            <div class="d-flex align-items-center mb-3 mb-sm-0 mr-sm-4">
                                <MudCheckBox T="bool" @bind-Checked="_isChecked" Class="mr-2 ad-checkbox" />
                                @*   <img src="/qln-images/subscription/Gucci.png" alt="Ad Image"
                             style="width: 240px; max-width:100%; height: auto; max-height: 180px; border-radius: 4px;" /> *@
                                @if (ad.ImageUrls != null && ad.ImageUrls.Any() && !string.IsNullOrEmpty(ad.ImageUrls.First().Url))
                                {
                                    <div class="position-relative ad-image-wrapper">
                                        <img src="@ad.ImageUrls.First().Url" alt="Ad Image" class="ad-image" />

                                        @if (ad.IsFeatured)
                                        {
                                            <div class="promoted-badge">
                                                <img src="/qln-images/subscription/Lightning.svg" style="width: 12px; height: 12px;" />
                                                <span>Featured</span>
                                            </div>
                                        }
                                        else if (ad.IsPromoted)
                                        {
                                            <div class="promoted-badge">
                                                <img src="/qln-images/subscription/Lightning.svg" style="width: 12px; height: 12px;" />
                                                <span>Promoted</span>
                                            </div>
                                        }
                                    </div>
                                }
                                else
                                {
                                    <img src="/qln-images/subscription/Gucci.png" alt="No Image" style="width: 240px; max-width:100%; height: auto; max-height: 180px; border-radius: 4px;" />
                                }

                            </div>

                            <!-- Second Column (Main Content) -->
                            <div style="flex:1">
                                <!-- Category (Row 2) -->
                                <MudText Typo="Typo.body2"
                                         Style="font-family: 'Public Sans', sans-serif; font-weight: 500; font-size: 11px; line-height: 12px; letter-spacing: 0; color: #646464; margin-bottom: 4px;">
                                    @ad.Category
                                </MudText>

                                <!-- Title (Row 3) -->
                                <MudText Typo="Typo.h6"
                                         Style="font-family: 'Public Sans', sans-serif; font-weight: 500; font-size: 14px; line-height: 20px; letter-spacing: 0; color: #00426D; margin-bottom: 4px;">
                                    @ad.Title
                                </MudText>

                                <!-- Certificate + Location + Status + Expiry (Row 4) -->
                                <div class="d-flex flex-column flex-sm-row justify-content-between align-items-sm-center mb-2">
                                    <!-- Left: Location -->
                                    <div class="d-flex align-items-center">
                                        <MudIcon Icon="@Icons.Material.Outlined.Place" Size="Size.Small" Style="color: #646464;" />
                                        <MudText Typo="Typo.caption"
                                                 Style="margin-left:4px;font-family: 'Public Sans', sans-serif; font-weight: 500; font-size: 14px; line-height: 12px; letter-spacing: 0; color: #646464;">
                                            @ad.Location
                                        </MudText>
                                    </div>

                                    <!-- Right: Status Chip + Expiry -->
                                    <div class="d-flex flex-column align-items-sm-center mt-1 mt-sm-0">
                                        <MudChip T="string" Style="@GetStatusStyle(ad.Status)"
                                                 Color="Color.Default"
                                                 Variant="Variant.Outlined"
                                                 Size="Size.Small">
                                            @GetStatusLabel(ad.Status)
                                        </MudChip>
                                        <div Class="mt-1 px-2 py-1" Style="background-color: #EDFAFF; border-radius: 4px; display: inline-block;">
                                            <img src="/qln-images/subscription/expire.svg" alt="Expire Icon" style="width: 14px; height: 14px;" />


                                            <MudText Typo="Typo.caption"
                                                     Style="font-family: 'Public Sans', sans-serif; font-weight: 500; font-size: 11px; color: #0071AF;">
                                                Expires: @ad.ExpiryDate.ToString("dd MMM yyyy")
                                            </MudText>
                                        </div>

                                    </div>
                                </div>


                                <!-- Price (Row 5) -->
                                <MudText Typo="Typo.h6"
                                         Style="font-family: 'Public Sans', sans-serif; font-weight: 600; font-size: 20px; line-height: 34px; letter-spacing: 0; color: #242424;">
                                    @ad.Price @ad.PriceType
                                </MudText>

                                <!-- Buttons (Row 6) -->
                                <div class="d-flex flex-wrap mt-2" style="gap: 8px;">
                                    <MudButton Variant="Variant.Text"
                                               Style="text-transform: none; background-color: #F5F6FA; border-radius: 4px; color: #242424; display: flex; align-items: center;">
                                        <img src="qln-images/subscription/Refresh.svg" alt="Gucci" style="margin-right: 8px;" />
                                        <div>
                                            Refresh
                                            <div style="font-size: 0.7em; color: #5F6C7B;">(Exp: @ad.RefreshExpiry)</div>

                                        </div>
                                    </MudButton>

                                    <!-- Promote Button -->
                                    @if (ad.IsPromoted)
                                    {
                                        <MudButton Variant="Variant.Text"
                                                   Disabled="true"
                                                   Style="text-transform: none; background-color: #F5F6FA; border-radius: 4px; color:#667085;">
                                            <img src="qln-images/subscription/LightningGrey.svg" style="margin-right: 8px;" alt="Promoted" />

                                            <div>
                                                Promoted

                                                <div style="font-size: 0.7em; color: #5F6C7B;">(Exp: @ad.RefreshExpiry)</div>

                                            </div>
                                        </MudButton>
                                    }
                                    else
                                    {
                                        <MudButton Variant="Variant.Text"
                                                   Style="text-transform: none; background-color: #F5F6FA; border-radius: 4px; color: #242424;">
                                            <img src="qln-images/subscription/Feature.svg" style="margin-right: 8px;" alt="Promote" />
                                            Pay to Promote
                                        </MudButton>
                                    }
                                    @if (ad.IsFeatured)
                                    {
                                        <MudButton Variant="Variant.Text"
                                                   Disabled="true"
                                                   Style="text-transform: none; background-color: #F5F6FA; border-radius: 4px; color: #667085;">
                                            <img src="qln-images/subscription/LightningGrey.svg" style="margin-right: 8px;" alt="Featured" />
                                            <div>
                                                Featured

                                                <div style="font-size: 0.7em; color: #5F6C7B;">(Exp: @ad.RefreshExpiry)</div>

                                            </div>
                                        </MudButton>
                                    }
                                    else
                                    {
                                        <MudButton Variant="Variant.Text"
                                                   Style="text-transform: none; background-color: #F5F6FA; border-radius: 4px; color: #242424;">
                                            <img src="qln-images/subscription/Feature.svg" style="margin-right: 8px;" alt="Feature" />
                                            Pay to Feature
                                        </MudButton>
                                    }
                                    <MudMenu OffsetY="true"
                                             AnchorOrigin="Origin.BottomRight"
                                             TransformOrigin="Origin.BottomRight"
                                             class="custom-menu-width">
                                        <ActivatorContent>
                                            <MudIconButton Icon="@Icons.Material.Filled.MoreVert" />
                                        </ActivatorContent>
                                        <ChildContent>
                                            <MudMenuItem @onclick="() => UnPublishAd(ad.Id)" Class="menu-item-style">
                                                <img src="/qln-images/subscription/unpublish.svg" class="menu-icon" />
                                                <span>Unpublish</span>
                                            </MudMenuItem>
                                            <MudMenuItem @onclick="() => OnEditAd(ad.Id)" Class="menu-item-style">
                                                <img src="/qln-images/subscription/edit.svg" class="menu-icon" />
                                                <span>Edit Ad</span>
                                            </MudMenuItem>
                                            <MudMenuItem @onclick="() => onPreview(ad.Id)" Class="menu-item-style">
                                                <img src="/qln-images/subscription/preview.svg" class="menu-icon" />
                                                <span>Preview </span>
                                            </MudMenuItem>
                                            <MudMenuItem @onclick="() => onRemove(ad.Id)" Class="menu-item-style">
                                                <img src="/qln-images/subscription/remove.svg" class="menu-icon" />
                                                <span>Remove </span>
                                            </MudMenuItem>
                                        </ChildContent>
                                    </MudMenu>
                                </div>
                            </div>
                        </MudPaper>

                        <!-- Stats + Status -->
                        <MudPaper Class="d-flex flex-column flex-sm-row align-items-sm-center px-4 py-2 mb-4"
                                  Style="margin-top:10px;border-radius:0; border:none; border-bottom:1px solid #EAECF0; box-shadow:none;">
                            <!-- Stats -->
                            <div class="d-flex flex-wrap" style="flex: 1; gap: 16px;">
                                <div class="d-flex align-items-center" style="gap: 6px; color: #5F6C7B;">
                                    <img src="qln-images/subscription/ImpressionBlue.svg" class="post-analytics-svg-icon" />
                                    <MudText Class="post-analytics-text" Style="margin: 0;">
                                        <span class="stat-label">
                                            Impressions :
                                            <span class="stat-value">@ad.Impressions</span>
                                        </span>
                                    </MudText>
                                </div>
                                <div class="d-flex align-items-center" style="gap: 6px; color: #5F6C7B;">
                                    <img src="qln-images/subscription/ViewBlue.svg" class="post-analytics-svg-icon" />
                                    <MudText Class="post-analytics-text" Style="margin: 0;">
                                        <span class="stat-label">
                                            Views:
                                            <span class="stat-value"> @ad.Views</span>
                                        </span>
                                    </MudText>
                                </div>
                                <div class="d-flex align-items-center" style="gap: 6px; color: #5F6C7B;">
                                    <img src="qln-images/subscription/CallBlue.svg" class="post-analytics-svg-icon" />
                                    <MudText Class="post-analytics-text" Style="margin: 0;">
                                        <span class="stat-label">
                                            Calls:
                                            <span class="stat-value"> @ad.Calls</span>
                                        </span>
                                    </MudText>
                                </div>
                                <div class="d-flex align-items-center" style="gap: 6px; color: #5F6C7B;">
                                    <img src="qln-images/subscription/WhatsappBlue.svg" class="post-analytics-svg-icon" />
                                    <MudText Class="post-analytics-text" Style="margin: 0;">
                                        <span class="stat-label">
                                            WhatsApp:
                                            <span class="stat-value"> @ad.WhatsAppClicks</span>
                                        </span>
                                    </MudText>
                                </div>
                                <div class="d-flex align-items-center" style="gap: 6px; color: #5F6C7B;">
                                    <img src="qln-images/subscription/ShareBlue.svg" class="post-analytics-svg-icon" />
                                    <MudText Class="post-analytics-text" Style="margin: 0;">
                                        <span class="stat-label">
                                            Shares:
                                            <span class="stat-value"> @ad.Shares</span>
                                        </span>
                                    </MudText>
                                </div>
                                <div class="d-flex align-items-center" style="gap: 6px; color: #5F6C7B;">
                                    <img src="qln-images/subscription/SaveBlue.svg" class="post-analytics-svg-icon" />
                                    <MudText Class="post-analytics-text" Style="margin: 0;">
                                        <span class="stat-label">
                                            Saves:
                                            <span class="stat-value"> @ad.Saves</span>
                                        </span>
                                    </MudText>
                                </div>
                            </div>

                            <MudText Typo="Typo.caption" Class="mt-2 mt-sm-0" Style="color: #5F6C7B;">Listed on @ad.CreatedDate</MudText>
                        </MudPaper>
                    }
                }
                else
                {
                    <EmptyCard Title="No Published Ads" Subtitle="You have not published any ads yet." />

                }

            }
            else if (_selectedAdsTab == 1)
            {
                @if (_isUnpublishedLoading)
                {
                    <div class="d-flex justify-content-center mt-4 mb-4">
                        <MudProgressCircular Color="Color.Primary" Indeterminate="true" Size="Size.Medium" />
                    </div>
                }
                else if (unpublishedAds != null && unpublishedAds.Any())
                {

                    <!-- Published Ads -->
                    @foreach (var ad in unpublishedAds)
                    {
                        <MudPaper Class="ad-container d-flex flex-column flex-sm-row mt-4 "
                                  Style="border-radius: 0; border: none; border-bottom: 1px solid #EAECF0; box-shadow: none;">
                            <!-- First Row (Image + Checkbox) - full width on mobile -->
                            <div class="d-flex align-items-center mb-3 mb-sm-0 mr-sm-4">
                                <MudCheckBox T="bool" @bind-Checked="_isChecked" Class="mr-2 ad-checkbox" />
                                @*   <img src="/qln-images/subscription/Gucci.png" alt="Ad Image"
                             style="width: 240px; max-width:100%; height: auto; max-height: 180px; border-radius: 4px;" /> *@
                                @if (ad.ImageUrls != null && ad.ImageUrls.Any() && !string.IsNullOrEmpty(ad.ImageUrls.First().Url))
                                {
                                    <div class="position-relative ad-image-wrapper">
                                        <img src="@ad.ImageUrls.First().Url" alt="Ad Image" class="ad-image" />

                                        @if (ad.IsFeatured)
                                        {
                                            <div class="promoted-badge">
                                                <img src="/qln-images/subscription/Lightning.svg" style="width: 12px; height: 12px;" />
                                                <span>Featured</span>
                                            </div>
                                        }
                                        else if (ad.IsPromoted)
                                        {
                                            <div class="promoted-badge">
                                                <img src="/qln-images/subscription/Lightning.svg" style="width: 12px; height: 12px;" />
                                                <span>Promoted</span>
                                            </div>
                                        }
                                    </div>
                                }
                                else
                                {
                                    <img src="/qln-images/subscription/Gucci.png" alt="No Image" style="width: 240px; max-width:100%; height: auto; max-height: 180px; border-radius: 4px;" />
                                }

                            </div>

                            <!-- Second Column (Main Content) -->
                            <div style="flex:1">
                                <!-- Category (Row 2) -->
                                <MudText Typo="Typo.body2"
                                         Style="font-family: 'Public Sans', sans-serif; font-weight: 500; font-size: 11px; line-height: 12px; letter-spacing: 0; color: #646464; margin-bottom: 4px;">
                                    @ad.Category
                                </MudText>

                                <!-- Title (Row 3) -->
                                <MudText Typo="Typo.h6"
                                         Style="font-family: 'Public Sans', sans-serif; font-weight: 500; font-size: 14px; line-height: 20px; letter-spacing: 0; color: #00426D; margin-bottom: 4px;">
                                    @ad.Title
                                </MudText>

                                <!-- Certificate + Location + Status + Expiry (Row 4) -->
                                <div class="d-flex flex-column flex-sm-row justify-content-between align-items-sm-center mb-2">
                                    <!-- Left: Location -->
                                    <div class="d-flex align-items-center">
                                        <MudIcon Icon="@Icons.Material.Outlined.Place" Size="Size.Small" Style="color: #646464;" />
                                        <MudText Typo="Typo.caption"
                                                 Style="margin-left:4px;font-family: 'Public Sans', sans-serif; font-weight: 500; font-size: 14px; line-height: 12px; letter-spacing: 0; color: #646464;">
                                            @ad.Location
                                        </MudText>
                                    </div>

                                    <!-- Right: Status Chip + Expiry -->
                                    <div class="d-flex flex-column align-items-sm-center mt-1 mt-sm-0">
                                        <MudChip T="string" Style="@GetStatusStyle(ad.Status)"
                                                 Color="Color.Default"
                                                 Variant="Variant.Outlined"
                                                 Size="Size.Small">
                                            @GetStatusLabel(ad.Status)
                                        </MudChip>
                                        <div Class="mt-1 px-2 py-1" Style="background-color: #EDFAFF; border-radius: 4px; display: inline-block;">
                                                            <img src="/qln-images/subscription/expire.svg" alt="Expire Icon" style="width: 14px; height: 14px;" />

                                            <MudText Typo="Typo.caption"
                                                     Style="font-family: 'Public Sans', sans-serif; font-weight: 500; font-size: 11px; color: #0071AF;">
                                                Expires: @ad.ExpiryDate.ToString("dd MMM yyyy")
                                            </MudText>
                                        </div>
                                    </div>
                                </div>


                                <!-- Price (Row 5) -->
                                <MudText Typo="Typo.h6"
                                         Style="font-family: 'Public Sans', sans-serif; font-weight: 600; font-size: 20px; line-height: 34px; letter-spacing: 0; color: #242424;">
                                    @ad.Price @ad.PriceType
                                </MudText>

                                <!-- Buttons (Row 6) -->
                                <div class="d-flex flex-wrap mt-2" style="gap: 8px;">
                                    <MudButton Variant="Variant.Text"
                                               Style="text-transform: none; background-color: #F5F6FA; border-radius: 4px; color: #242424; display: flex; align-items: center;">
                                        <img src="qln-images/subscription/Refresh.svg" alt="Gucci" style="margin-right: 8px;" />
                                        <div>
                                            Refresh
                                            <div style="font-size: 0.7em; color: #5F6C7B;">(Exp: @ad.RefreshExpiry)</div>

                                        </div>
                                    </MudButton>

                                    <!-- Promote Button -->
                                    @if (ad.IsPromoted)
                                    {
                                        <MudButton Variant="Variant.Text"
                                                   Disabled="true"
                                                   Style="text-transform: none; background-color: #F5F6FA; border-radius: 4px; color:#667085;">
                                            <img src="qln-images/subscription/LightningGrey.svg" style="margin-right: 8px;" alt="Promoted" />

                                            <div>
                                                Promoted

                                                <div style="font-size: 0.7em; color: #5F6C7B;">(Exp: @ad.RefreshExpiry)</div>

                                            </div>
                                        </MudButton>
                                    }
                                    else
                                    {
                                        <MudButton Variant="Variant.Text"
                                                   Style="text-transform: none; background-color: #F5F6FA; border-radius: 4px; color: #242424;">
                                            <img src="qln-images/subscription/Feature.svg" style="margin-right: 8px;" alt="Promote" />
                                            Pay to Promote
                                        </MudButton>
                                    }
                                    @if (ad.IsFeatured)
                                    {
                                        <MudButton Variant="Variant.Text"
                                                   Disabled="true"
                                                   Style="text-transform: none; background-color: #F5F6FA; border-radius: 4px; color: #667085;">
                                            <img src="qln-images/subscription/LightningGrey.svg" style="margin-right: 8px;" alt="Featured" />
                                            <div>
                                                Featured

                                                <div style="font-size: 0.7em; color: #5F6C7B;">(Exp: @ad.RefreshExpiry)</div>

                                            </div>
                                        </MudButton>
                                    }
                                    else
                                    {
                                        <MudButton Variant="Variant.Text"
                                                   Style="text-transform: none; background-color: #F5F6FA; border-radius: 4px; color: #242424;">
                                            <img src="qln-images/subscription/Feature.svg" style="margin-right: 8px;" alt="Feature" />
                                            Pay to Feature
                                        </MudButton>
                                    }
                                    <MudMenu OffsetY="true"
                                             AnchorOrigin="Origin.BottomRight"
                                             TransformOrigin="Origin.BottomRight">
                                        <ActivatorContent>
                                            <MudIconButton Icon="@Icons.Material.Filled.MoreVert" />
                                        </ActivatorContent>
                                        <ChildContent>
                                            <MudMenuItem @onclick="() => OnPublishAd(ad.Id)" Class="menu-item-style">
                                                <img src="/qln-images/subscription/unpublish.svg" class="menu-icon" />
                                                Publish Ad
                                            </MudMenuItem>
                                            <MudMenuItem @onclick="() => OnEditAd(ad.Id)" Class="menu-item-style">
                                                <img src="/qln-images/subscription/edit.svg" class="menu-icon" />
                                                Edit Ad
                                            </MudMenuItem>
                                            <MudMenuItem @onclick="() => onPreview(ad.Id)" Class="menu-item-style">
                                                <img src="/qln-images/subscription/preview.svg" class="menu-icon" />
                                                <span>Preview </span>
                                            </MudMenuItem>
                                            <MudMenuItem @onclick="() => onRemove(ad.Id)" Class="menu-item-style">
                                                <img src="/qln-images/subscription/remove.svg" class="menu-icon" />
                                                <span>Remove </span>
                                            </MudMenuItem>
                                        </ChildContent>
                                    </MudMenu>
                                </div>
                            </div>
                        </MudPaper>

                        <!-- Stats + Status -->
                        <MudPaper Class="d-flex flex-column flex-sm-row align-items-sm-center px-4 py-2 mb-4"
                                  Style="margin-top:10px;border-radius:0; border:none; border-bottom:1px solid #EAECF0; box-shadow:none;">
                            <!-- Stats -->
                            <div class="d-flex flex-wrap" style="flex: 1; gap: 16px;">
                                <div class="d-flex align-items-center" style="gap: 6px; color: #5F6C7B;">
                                    <img src="qln-images/subscription/ImpressionBlue.svg" class="post-analytics-svg-icon" />
                                    <MudText Class="post-analytics-text" Style="margin: 0;">
                                        <span class="stat-label">
                                            Impressions :
                                            <span class="stat-value">@ad.Impressions</span>
                                        </span>
                                    </MudText>
                                </div>
                                <div class="d-flex align-items-center" style="gap: 6px; color: #5F6C7B;">
                                    <img src="qln-images/subscription/ViewBlue.svg" class="post-analytics-svg-icon" />
                                    <MudText Class="post-analytics-text" Style="margin: 0;">
                                        <span class="stat-label">
                                            Views:
                                            <span class="stat-value"> @ad.Views</span>
                                        </span>
                                    </MudText>
                                </div>
                                <div class="d-flex align-items-center" style="gap: 6px; color: #5F6C7B;">
                                    <img src="qln-images/subscription/CallBlue.svg" class="post-analytics-svg-icon" />
                                    <MudText Class="post-analytics-text" Style="margin: 0;">
                                        <span class="stat-label">
                                            Calls:
                                            <span class="stat-value"> @ad.Calls</span>
                                        </span>
                                    </MudText>
                                </div>
                                <div class="d-flex align-items-center" style="gap: 6px; color: #5F6C7B;">
                                    <img src="qln-images/subscription/WhatsappBlue.svg" class="post-analytics-svg-icon" />
                                    <MudText Class="post-analytics-text" Style="margin: 0;">
                                        <span class="stat-label">
                                            WhatsApp:
                                            <span class="stat-value"> @ad.WhatsAppClicks</span>
                                        </span>
                                    </MudText>
                                </div>
                                <div class="d-flex align-items-center" style="gap: 6px; color: #5F6C7B;">
                                    <img src="qln-images/subscription/ShareBlue.svg" class="post-analytics-svg-icon" />
                                    <MudText Class="post-analytics-text" Style="margin: 0;">
                                        <span class="stat-label">
                                            Shares:
                                            <span class="stat-value"> @ad.Shares</span>
                                        </span>
                                    </MudText>
                                </div>
                                <div class="d-flex align-items-center" style="gap: 6px; color: #5F6C7B;">
                                    <img src="qln-images/subscription/SaveBlue.svg" class="post-analytics-svg-icon" />
                                    <MudText Class="post-analytics-text" Style="margin: 0;">
                                        <span class="stat-label">
                                            Saves:
                                            <span class="stat-value"> @ad.Saves</span>
                                        </span>
                                    </MudText>
                                </div>
                            </div>

                            <MudText Typo="Typo.caption" Class="mt-2 mt-sm-0" Style="color: #5F6C7B;">Listed on @ad.CreatedDate</MudText>
                        </MudPaper>
                    }
                }
                else
                {
                    <EmptyCard Title="No Published Ads" Subtitle="You have not published any ads yet." />

                }

            }
        </MudPaper>
        @if ((publishedAds?.Any() ?? false) || (unpublishedAds?.Any() ?? false))
        {
            <PaginationFooter TotalItems="@TotalItems"
                              CurrentPage="@CurrentPage"
                              PageSize="@PageSize"
                              OnPageChange="HandlePageChange"
                              OnPageSizeChange="HandlePageSizeChange" />
        }


    </MudContainer>
</div>

<style>
    .dashboard-container {
        padding: 20px 40px;
        background-color: #F2F4F7;
    }

    .dashboard-option {
        display: flex;
        align-items: center;
        gap: 4px;
        margin-top: 16px;
        padding: 0px 20px;
    }

    .dashboard-text {
        font-family: 'Public Sans', sans-serif;
        font-weight: 500;
        font-size: 16px;
        line-height: 24px;
        color: #454545;
        vertical-align: middle;
    }

    .dropdown-icon {
        color: #454545;
        font-size: 24px;
    }

    .dashboard-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 12px;
        width: 100%;
    }

    .dashboard-title-container {
        flex: 1;
        text-align: center;
    }

    .dashboard-title {
        font-family: 'Public Sans', sans-serif;
        font-weight: 600;
        font-size: 25px;
        line-height: 26px;
        color: #242424;
    }

    .dashboard-button-container {
        margin-left: auto;
    }

    .dashboard-edit-profile-button {
        margin-top: 12px;
    }

    .dashboard-statistics-container {
        padding: 16px;
        display: flex;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: 16px;
        background-color: white;
        margin-top: 24px;
    }

    .dashboard-company-container {
        width: 260px;
        padding: 16px;
        display: flex;
        flex-direction: column;
        align-items: center;
        border-radius: 12px;
        background-color: #FAFAFA;
    }

    .dashboard-company-logo {
        width: 80px;
        height: 80px;
    }

    .dashboard-edit-profile-button {
        border-radius: 8px;
        border: 1px solid #F26D1E;
        background-color: white;
        color: #F26D1E;
        width: 200px;
    }

    .statistics-content {
        flex: 1;
        min-width: 0;
    }

    .statistics-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 16px;
    }

    .dashboard-statistics-title {
        font-family: 'Public Sans', sans-serif;
        font-weight: 600;
        font-size: 18px;
        line-height: 26px;
        letter-spacing: 0;
        vertical-align: middle;
        color: #242424;
    }

    .stat-paper {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 20px;
        border-radius: 4px;
        height: 100px !important;
        background-color: #F9FAFB;
        padding: 16px;
    }

    .stat-icon {
        width: 32px;
        height: 32px;
    }

    .stat-title {
        font-family: 'Public Sans', sans-serif;
        font-weight: 600;
        font-size: 14px;
        line-height: 24px;
        color: #242424;
        margin-bottom: 4px;
    }

    .stat-value {
        font-family: 'Public Sans', sans-serif;
        font-weight: 500;
        font-size: 14px;
        color: #004F9A;
        text-align: center;
    }

    .my-ad-section {
        display: flex;
        width: 100%;
        margin-top: 40px;
        justify-content: space-between;
        align-items: center;
    }

    .my-ad-toolbar-section {
        width: 20%
    }

    .dashboard-tabs-toolbar {
        display: flex;
        width: 100%;
        background-color: rgb(245, 245, 245);
        padding: 0px;
        border-radius: 4px 4px 0px 0px;
        overflow: hidden;
    }

    .dashboard-tab {
        min-width: 0px;
        text-align: center;
        color: rgb(102, 102, 102);
        text-transform: none;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        align-items: center;
        position: relative;
        background-color: rgb(245, 245, 245);
        flex: 1 1 0%;
        padding: 12px 0px;
        margin: 0px;
        transition: 0.3s;
    }

        .dashboard-tab.active {
            background-color: white;
            color: #F26D1E;
            font-weight: 600;
        }

    .dashboard-tab-text {
        color: #F26D1E;
    }

    .ad-container {
        padding: 16px 0px;
    }

    .dashboard-tab-indicator {
        position: absolute;
        bottom: 0px;
        height: 3px;
        background-color: #F26D1E;
        width: 100%;
        transition: transform 0.3s;
    }

    .search-wrapper {
        display: flex;
        align-items: center;
        border: 1px solid #D0D5DD;
        border-radius: 6px;
        padding: 4px 8px;
        max-width: 300px;
        background-color: white;
    }

    .search-icon {
        width: 18px;
        height: 18px;
    }

    .custom-search-field input {
        padding-left: 8px;
    }



    .no-underline .mud-input-underline::before,
    .no-underline .mud-input-underline::after {
        border-bottom: none !important;
    }


    .ad-checkbox input[type="checkbox"]:checked + .mud-checkbox-background {
        background-color: #D0D5DD !important;
        border-color: #D0D5DD !important;
    }

    .ad-checkbox .mud-icon-root.mud-svg-icon {
        fill: #D0D5DD !important;
    }

    .post-analytics-svg-icon {
        width: 16px;
        height: 16px;
        color: #00426D;
    }

    .ad-image-wrapper {
        position: relative;
    }

    .ad-image {
        width: 240px;
        max-width: 100%;
        height: auto;
        max-height: 180px;
        border-radius: 4px;
    }

    /* Badge styles */
    .promoted-badge {
        position: absolute;
        top: 12px;
        left: 0;
        display: flex;
        align-items: center;
        gap: 2px;
        background-color: #FF7F38;
        color: white;
        padding: 4px 6px;
        border-radius: 0px 4px 4px 0px;
        font-size: 12px;
        font-weight: 500;
        width: fit-content;
        height: 20px;
    }

    .post-analytics-text {
        font-family: 'Public Sans'/sans-serif;
        font-weight: 500;
        font-size: 13px;
        line-height: 22px;
        letter-spacing: 0;
        text-align: center;
    }

    .post-analytics-text-stat-label {
        color: #242424;
    }

    .post-analytics-text-stat-value {
        color: #00426D;
        margin-left: 4px;
    }

    .custom-menu-width .mud-popover {
        min-width: 200px;
    }

    .menu-item-style {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 12px;
        width: 150px;
        padding-left: 20px;
    }

    .menu-icon {
        width: 18px;
        height: 18px;
    }


    @@media (max-width: 1007px) {
        .dashboard-container {
            padding-left: 0px;
            padding-right: 0px;
        }
    }


    @@media (max-width: 800px) {
        .dashboard-statistics-container {
            flex-direction: column;
        }

        .dashboard-company-container {
            width: 100%;
        }

        .statistics-content {
            width: 100%;
        }
    }

    @@media (min-width: 530px) and (max-width: 800px) {
        .stat-item {
            flex-basis: 50% !important;
            max-width: 50% !important;
        }
    }

    @@media (max-width: 600px) {
        .stat-item {
            padding: 8px !important;
        }

        .stat-paper {
            height: 90px;
            gap: 16px;
            padding: 12px;
        }
    }


    /* For screens 393px and below (mobile) */
    @@media (max-width: 393px) {
        .dashboard-container {
            padding-left: 0;
            padding-right: 0;
            padding-top: 16px;
            padding-bottom: 16px;
        }

        .stat-paper {
            flex-direction: column;
            height: auto;
            gap: 8px;
            padding: 16px 8px;
        }

        .stat-icon {
            margin-bottom: 8px;
        }

        .stat-title,
        .stat-value {
            text-align: center;
            font-size: 13px;
        }

        .my-ad-section {
            display: flex;
            flex-direction: row;
            width: 100%;
            margin-top: 20px;
        }

        .my-ad-toolbar-section {
            width: 100%
        }


        .d-flex.flex-column.flex-sm-row {
            flex-direction: column !important;
        }

        .ml-sm-auto {
            margin-left: 0 !important;
        }

        .mt-2.mt-sm-0 {
            margin-top: 8px !important;
        }

        .d-flex.flex-column.flex-sm-row {
            flex-direction: column !important;
        }

        .mb-3.mb-sm-0 {
            margin-bottom: 12px !important;
        }

        .mr-sm-4 {
            margin-right: 0 !important;
        }

        img {
            max-width: 100% !important;
            height: auto !important;
        }

        .d-flex.flex-wrap {
            gap: 8px !important;
        }
        /* Stats section */
        .d-flex.flex-column.flex-sm-row.align-items-sm-center {
            flex-direction: column !important;
            align-items: flex-start !important;
        }

        .mt-2.mt-sm-0 {
            margin-top: 8px !important;
        }

        .ad-checkbox {
            display: none !important;
        }

        .ad-container {
            padding: 0.5rem !important;
        }
    }
</style>