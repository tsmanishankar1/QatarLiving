<MudGrid>
    <MudItem sm="12" md="12">
        @if (_isLoading)
        {
            <MudProgressLinear Indeterminate="true" Color="Color.Primary" Class="my-2" />
        }
        <MessageInput OnSend="SendMessageAsync" DisableChatInput="_isLoading" />
    </MudItem>
    <MudItem sm="12" md="12">
        <div class="description-container">
            <!-- Custom header with copy button -->
            <div class="description-header">
                <MudText Typo="Typo.subtitle1">Description</MudText>
                <MudIconButton Icon="@Icons.Material.Filled.ContentCopy"
                               Size="Size.Small"
                               OnClick="@(() => CopyToClipboard(Description))"
                               Title="Copy to clipboard" />
            </div>

            <!-- Borderless TextField -->
            <MudTextField @bind-Value="Description"
                          Variant="Variant.Text"
                          Lines="20"
                          MinRows="10"
                          MaxRows="1000"
                          AutoGrow
                          Immediate
                          Class="description-text-field borderless-field" />
        </div>
    </MudItem>
</MudGrid>

<style>
    .description-container {
        height: calc(100vh - 11.2rem);
        display: flex;
        flex-direction: column;
        padding: 0;
        overflow: hidden; /* Prevent container overflow */
    }

    /* Header with copy button */
    .description-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 4px;
        padding: 0 4px;
    }

    .description-text-field {
        flex: 1;
        display: flex;
        flex-direction: column;
        overflow: hidden; /* Prevent text field container overflow */
    }

        .description-text-field .mud-input-control {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .description-text-field .mud-input-control-input-container {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden; /* Prevent container overflow */
        }

        .description-text-field .mud-input-slot {
            overflow-y: auto !important; /* Force vertical scrolling */
            padding: 8px;
        }

        /* Ensure input field takes full height but allows scrolling */
        .description-text-field .mud-input-text {
            overflow-y: auto !important; /* Force scrolling */
            max-height: 100%;
            padding: 4px;
        }

    /* Completely remove borders from text field */
    .borderless-field .mud-input.mud-input-text {
        border: none !important;
        box-shadow: none !important;
    }

    .borderless-field.mud-text-field {
        background-color: #f8f9fa; /* Optional: light background to differentiate from page */
        padding: 8px;
    }

    .borderless-field .mud-input-adornment {
        margin-top: 0;
    }

    .borderless-field .mud-input-underline::before,
    .borderless-field .mud-input-underline::after {
        display: none; /* Remove underline for text variant */
    }

    /* Hide label to save space - we're using the custom header instead */
    .description-text-field .mud-input-label {
        display: none;
    }
</style>
