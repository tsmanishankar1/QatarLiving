@inherits LayoutComponentBase
@using MudBlazor
@using QLN.Web.Shared.Components.FooterFolder
@inject NavigationManager NavManager
@inject UserState UserState
@inject ISnackbar Snackbar

<MudThemeProvider />
<MudDialogProvider />
<MudPopoverProvider />
<MudSnackbarProvider Position="SnackbarPosition.BottomLeft" />


<header class="site-header mud-elevation-1">
    <div class="header-left">
        <NavLink href="/">
            <MudImage Src="images/logo.png" Alt="Qatar Living" Height="30" />
        </NavLink>
    </div>

    <nav class="nav-links">
        <NavLink href="/daily" style="color: white;" class="nav-link">Daily</NavLink>
        <NavLink href="/user-profile" style="color: white;" class="nav-link">Properties</NavLink>
        <NavLink href="/vehicles" style="color: white;" class="nav-link">Vehicles</NavLink>
        <NavLink href="/classifieds" style="color: white;" class="nav-link active">Classifieds</NavLink>
        <NavLink href="/authnetication-setup" style="color: white;" class="nav-link">Services</NavLink>
        <NavLink href="/two-factor-authentication" style="color: white;" class="nav-link">Jobs</NavLink>
        <NavLink href="/ads-posted" style="color: white;" class="nav-link">Rewards</NavLink>
    </nav>

    <div class="header-right">
        <MudButton Variant="Variant.Filled" Color="Color.Warning" Size="Size.Small" StartIcon="@Icons.Material.Filled.Add" Class="post-ad-btn">
            Post
        </MudButton>

        <MudMenu OffsetY="true" AnchorOrigin="Origin.BottomRight" TransformOrigin="Origin.TopRight">
            <ActivatorContent>
                <div style="display: flex; align-items: center; gap: 0.5rem;" class="cursor-pointer">
                    @* <MudAvatar Size="Size.Medium">
                        <img src="https://randomuser.me/api/portraits/women/44.jpg" alt="User" style="width: 100%; height: 100%; border-radius: 50%;" />
                    </MudAvatar> *@
                    <span class="user-name">
                        @(UserState.IsLoggedIn ? UserState.Email : "Guest")
                    </span>
                </div>
            </ActivatorContent>

            <ChildContent>
                @if (UserState.IsLoggedIn)
                {
                    <MudButton Variant="Variant.Outlined"
                               Color="Color.Warning"
                               StartIcon="@Icons.Material.Filled.AccountCircle"
                                Style="margin: 8px 12px 8px 12px; color: #ff7b00; border-color: #ff7b00; width: calc(100% - 24px); font-weight: bold;"
                               OnClick="@GoToProfile">
                        My Profile
                    </MudButton>

                    <MudButton Variant="Variant.Filled"
                               Color="Color.Warning"
                               StartIcon="@Icons.Material.Filled.Logout"
                               Style="margin: 8px 12px; background-color: #ff7b00; color: white; width: calc(100% - 24px); font-weight: bold;"
                               OnClick="@Logout">
                        Logout
                    </MudButton>
                }
                else
                {
                    <MudButton Variant="Variant.Outlined"
                               Color="Color.Warning"
                               StartIcon="@Icons.Material.Filled.Login"
                               Style="margin: 8px 12px 8px 12px; color: #ff7b00; border-color: #ff7b00; width: calc(100% - 24px); font-weight: bold;"
                               OnClick="@(() => NavManager.NavigateTo("/login"))">
                        Login
                    </MudButton>

                    <MudButton Variant="Variant.Filled"
                               Color="Color.Warning"
                               StartIcon="@Icons.Material.Filled.PersonAdd"
                               Style="margin: 8px 12px; background-color: #ff7b00; color: white; width: calc(100% - 24px); font-weight: bold;"
                               OnClick="@(() => NavManager.NavigateTo("/signup"))">
                        Sign Up
                    </MudButton>
                }
            </ChildContent>
        </MudMenu>
    </div>
</header>

<main class="main-content">
    @Body
    <Footer />
</main>

@code {
    private void GoToProfile()
    {
        NavManager.NavigateTo("/profile"); 
    }

    private void Logout()
    {
        UserState.Email = null;
        UserState.Token = null;
        Snackbar.Add("Logged out successfully", Severity.Info);
        NavManager.NavigateTo("/");
    }
}
