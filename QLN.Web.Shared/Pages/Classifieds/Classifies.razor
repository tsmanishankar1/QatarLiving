@page "/classifieds"

@using QLN.Web.Shared.Pages.Classifieds.Components.Landing.Components
@using QLN.Web.Shared.Pages.Classifieds.Components.Landing
@using QLN.Web.Shared.Pages.Classifieds.Components.Items
@using QLN.Web.Shared.Pages.Classifieds.Components.Deals

<NavigationTabs OnTabChanged="HandleTabChanged" />

@if (isLoading)
{
    <MudProgressCircular Color="Color.Primary" Indeterminate="true" />
}
else if (string.IsNullOrEmpty(selectedKey))
{
    <Landing />
}
else
{
    @switch (selectedKey)
    {
        case "items":
            <Items />
            break;
        case "deals":
            <Deals />
            break;
        case "stores":
            <Items />
            break;
        case "preloved":
            <Items />
            break;
        case "collectibles":
            <Items />
            break;
    }
}

@code {
    private string? selectedKey = null;
    private bool isLoading = true;

    protected override void OnInitialized()
    {
        isLoading = false; // ðŸš€ Stop loading on first render
    }

    private async Task HandleTabChanged(string? key)
    {
        Console.WriteLine($"Selected Key: {key}");

        isLoading = true;
        StateHasChanged();

        await Task.Delay(100); // simulate data loading

        selectedKey = key;
        isLoading = false;
    }
}
