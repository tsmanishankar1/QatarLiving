@using MudBlazor
@using QLN.Web.Shared.Components.Classifieds.PromotedItemCards
@using QLN.Web.Shared.Pages.Classifieds.Skeletons
@using QLN.Web.Shared.Components.EmptyCard
@using QLN.Web.Shared.Components.PriceSelect
@using QLN.Web.Shared.Components.BreadCrumb
@using QLN.Web.Shared.Components.PaginationFooter
@using QLN.Web.Shared.Components.CustomSelect
@inject NavigationManager NavigationManager
@inherits PrelovedListSectionBase

<Breadcrumb Items="breadcrumbItems" />
<div class="item-list">
     <div class="item-list-header">
        <h1 class="item-list-header-title">@($"Items in Qatar ({Items.Count} results)")</h1>
        <div class="item-list-header-sort-section">
            <label class="item-list-header-sort-label">Sort by:</label>
            <div class="item-list-header-sort-dropdown">
                <PriceSelect TItem="SortOption"
             Label=""
             Placeholder="Default"
             Items="sortOptions"
             SelectedId="@selectedSort"
             SelectedIdChanged="OnSortChanged"
             GetId="option => option.Id"
             GetLabel="option => option.Label" />

            </div>
        </div>
</div>
    
    @if (Loading)
    {
        <MudGrid GutterSize="16px" Class="max-width-List">
            @for (int i = 0; i < 9; i++)
            {
                <MudItem xs="12" sm="6" md="4">
                    <FeaturedItemSkeletonCard />
                </MudItem>
            }
        </MudGrid>
    }
    else if (PagedItems == null || !PagedItems.Any())
    {
        <div class="empty-wrapper">
            <EmptyCard Title="No items found." Subtitle="Try adjusting your filters or search keywords." />
        </div>
    }
    else
    {
        @if (ViewMode == "grid")
        {
            <MudGrid GutterSize="16px" Class="max-width-List">
                @foreach (var item in PagedItems)
                {
                    <MudItem xs="12" sm="6" md="4">
                        <PromotedItemGridCard Item="item" OnClickCard="OnClickCardItem" />
                    </MudItem>
                }
            </MudGrid>
        }
        else if (ViewMode == "list")
        {
            <div class="list-view-wrapper">
                <div class="list-view-left">
                    @foreach (var item in PagedItems)
                    {
                        <PromotedItemListCard Item="item" OnClickCard="OnClickCardItem"/>
                    }
                </div>

                <div class="list-view-right">
                    <img src="/qln-images/classifieds/ad_image.svg" alt="Ad Banner" class="ad-image" />
                </div>
            </div>

        }
        <!-- Pagination -->
        <PaginationFooter TotalItems="@Items.Count" CurrentPage="@currentPage" PageSize="@pageSize"
            OnPageChange="@HandlePageChange" OnPageSizeChange="@HandlePageSizeChange" />

    }


</div>

<style>
    .item-list {
        padding: 5px 0;
        font-family: 'Public Sans', sans-serif;
        
    }
    .max-width-List {
        max-width: 1068px;
        margin: 0 auto;
    }
    .footer-pagination-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        padding: 32px 40px 0;
    }

    .pagination-center {
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .empty-wrapper {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 300px;
        padding: 40px 20px;
    }

    .item-list-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 100%;
        margin-bottom: 1rem;
    }

    .item-list-header-title {
        margin: 0;
        font-size: 16px;
        font-weight: 500;
        color: #242424;
    }

    .item-list-header-sort-section {
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .item-list-header-sort-label {
        font-weight: 500;
        font-size: 13px;
        color: #242424;
    }

    .item-list-header-sort-dropdown {
        min-width: 180px;
    }

    .item-list-header-sort-section {
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .item-list-header-sort-dropdown {
        min-width: 155px;
    }

    .list-view-wrapper {
        display: flex;
        gap: 20px;
        align-items: flex-start;
    }

    .list-view-left {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 16px;
    }

    .list-view-right {
        width: 340px;
        flex-shrink: 0;
        position: sticky;
        top: 16px;
    }

    .ad-image {
        width: 100%;
        height: 384px;
        object-fit: cover;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }


    .pagination-container {
        margin-top: 24px;
    }
</style>