@using QLN.ContentBO.WebUI.Models
@using QLN.ContentBO.WebUI.Components.TableSkeleton
@using QLN.ContentBO.WebUI.Components.EmptyCard
@inherits FeaturedEventSlotsBase

@if (IsLoadingEvent)
{
    <TableSkeleton Rows="10" />
}
else if (FeaturedEventSlots == null || Categories == null)
{
      <div class="empty-card-wrapper">
        <EmptyCard Title="No Feature an Event found" Subtitle="Please check back later or explore other categories." />
    </div>
}
else
{
    var indexedFeatured = FeaturedEventSlots
        .Select((e, i) => new { Slot = e, Index = i + 1 })
        .ToList();

    <table class="table table-hover featured-table" style="width: 100%;">
        <thead>
            <tr>
                <th style="width: 40px;"></th> <!-- drag handle -->
                <th style="width: 60px;">Slot</th>
                <th>Title</th>
                <th>Category</th>
                <th>End Date</th>
                <th style="width: 120px;">Actions</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var context in indexedFeatured)
            {
                <tr data-slot-id="@context.Slot.SlotNumber">
                    <td>
                        <img src="/qln-images/arrow_icon.svg" 
                             class="@(context.Slot.Event?.EventTitle == "Feature an Event" ? "" : "drag-handle")" 
                             style="cursor: grab; width: 24px;" 
                             alt="drag" />
                    </td>
                    <td>@context.Index</td>
                    <td>
                        @if (context.Slot.Event?.EventTitle == "Feature an Event")
                        {
                            <span class="placeholder-text"
                                  style="color: #FF7F38; cursor: pointer;"
                                  @onclick="@(() => ReplaceSlot.InvokeAsync(context.Slot))">
                                @context.Slot.Event?.EventTitle
                            </span>
                        }
                        else
                        {
                            <a href="#" class="event-link" style="text-decoration: none; color: #787878;">
                                @context.Slot.Event?.EventTitle
                            </a>
                        }
                    </td>
                    <td>
                         @(
                        Categories.FirstOrDefault(c => c.Id == context.Slot.Event?.CategoryId)?.CategoryName 
                        ?? "--"
                    )
                    </td>
                    <td>
                        @(context.Slot.Event?.EventSchedule != null 
                        ? context.Slot.Event.EventSchedule.EndDate.ToString("dd-MM-yyyy") 
                        : "--")
                    </td>
                    <td>
                       @if (context.Slot.Event?.EventTitle == "Feature an Event")
                    {
                        <div class="d-flex align-center gap-2">
                        @* <div class="custom-delete-button"> *@
                        <img src="/qln-images/replace_icon1.svg" alt="delete" class="action-icon-style" />
                        @* </div> *@
                        <div class="custom-delete-button">
                        <img src="/qln-images/delete_icon1.svg" alt="delete" class="action-icon-style" />
                        </div>
                        </div>
                    }
                    else
                    {
                        <div class="d-flex align-center gap-2">
                        <div class="custom-delete-button">
                        <img src="/qln-images/replace_icon.svg"  @onclick="@(() => ReplaceSlot.InvokeAsync(context.Slot))" alt="delete" class="action-icon-style" />
                        </div>
                        <div class="custom-delete-button" 
                        @onclick="@(() => OnDelete.InvokeAsync(context?.Slot?.Event?.Id.ToString()))">
                        <img src="/qln-images/delete_icon.svg" alt="delete" class="action-icon-style" />
                        </div>
                        </div>
                    }
                    </td>
                </tr>
            }
        </tbody>
    </table>
}

<style>
    /* Base table styling */
.featured-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    border-radius: 8px;
    border: 1px solid var(--color-background-secondary-grey-medium);
    overflow: hidden;
     font-family: 'Public Sans', sans-serif;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

/* Header styling */
.featured-table thead th {
    background: var(--color-background-secondary-grey-medium);
    font-weight: 500;
    font-size: 14px;
    padding:  16px;
    text-align: left;
    color: var(--color-background-grey);
    border-bottom:none;
}

/* Row styling */
.featured-table tbody tr {
    padding: 16px;
    border-bottom: 1px solid var(var(--color-background-grey));
    transition: background 0.2s ease;
}

.featured-table tbody tr:hover {
    background: var(var(--color-background-grey));
}

/* Cell styling */
.featured-table tbody td {
    padding: 12px;
    vertical-align: middle;
    font-size: 14px;
    color: #333;
}

/* Drag handle */
.drag-handle {
    cursor: grab;
}

/* Action icons container */
.action-buttons {
    display: flex;
    align-items: center;
    gap: 8px;
}

/* Replace and delete buttons */
.action-button {
    display: inline-flex;
    justify-content: center;
    align-items: center;
    background: #f44336; /* Red */
    border-radius: 6px;
    width: 32px;
    height: 32px;
    cursor: pointer;
    transition: background 0.2s ease;
}

.action-button:hover {
    background: #d32f2f;
}

/* Action icons */
.action-button img {
    width: 18px;
    height: 18px;
    filter: brightness(0) invert(1); /* make icon white */
}
.custom-delete-button {
        background-color: #F44336; 
        border-radius: 12px; 
        padding: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        cursor: pointer;
    }

</style>

















