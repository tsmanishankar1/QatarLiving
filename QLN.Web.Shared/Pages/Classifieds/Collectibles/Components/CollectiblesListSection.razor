@using MudBlazor
@using QLN.Web.Shared.Components.Classifieds.PromotedItemCards
@using QLN.Web.Shared.Pages.Classifieds.Landing.Components.Skeletons.FeaturedItemSkeleton
@using QLN.Web.Shared.Components.EmptyCard
@using QLN.Web.Shared.Components.BreadCrumb
@using QLN.Web.Shared.Components.PaginationFooter
@using QLN.Web.Shared.Components.CustomSelect
@inherits CollectiblesListSectionBase
@inject NavigationManager NavigationManager

<Breadcrumb Items="breadcrumbItems" />
<div class="item-list">
    <div class="item-list-header">
        <div class="item-list-left">
            <h3 class="results-count">@($"Items in Qatar ({Items.Count} results)")</h3>
        </div>

        <div class="sort-section">
            <h3 class="sort-name">Sort by</h3>
            <CustomSelect TItem="string" Options="sortOptions.Select(x => x.Key).ToList()" SelectedItem="selectedSort"
                SelectedItemChanged="value => OnFilterChanged(nameof(selectedSort), value)" Placeholder="Sort by" />
        </div>
    </div>

    @if (Loading)
    {
        <MudGrid GutterSize="16px">
            @for (int i = 0; i < 9; i++)
            {
                <MudItem xs="12" sm="6" md="4">
                    <ItemSkeletonCard />
                </MudItem>
            }
        </MudGrid>
    }
    else if (PagedItems == null || !PagedItems.Any())
    {
        <div class="empty-wrapper">
            <EmptyCard Title="No items found." Subtitle="Try adjusting your filters or search keywords." />
        </div>
    }
    else
    {
        @if (ViewMode == "grid")
        {
            <MudGrid GutterSize="16px" style="padding: 0 40px;">
                @foreach (var item in PagedItems)
                {
                    <MudItem xs="12" sm="6" md="4">
                        <PromotedItemGridCard Item="item" />
                    </MudItem>
                }
            </MudGrid>
        }
        else if (ViewMode == "list")
        {
            <div class="list-view-wrapper">
                <div class="list-view-left">
                    @foreach (var item in PagedItems)
                    {
                        <PromotedItemListCard Item="item" />
                    }
                </div>

                <div class="list-view-right">
                    <img src="/qln-images/classifieds/ad_image.svg" alt="Ad Banner" class="ad-image" />
                </div>
            </div>

        }
        <!-- Pagination -->
        <PaginationFooter TotalItems="@Items.Count" CurrentPage="@currentPage" PageSize="@pageSize"
            OnPageChange="@HandlePageChange" OnPageSizeChange="@HandlePageSizeChange" />

    }



</div>

<style>
    .footer-pagination-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        padding: 32px 40px 0;
    }

    .pagination-center {
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .empty-wrapper {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 300px;
        padding: 40px 20px;
    }



    .item-list-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        margin-bottom: 1.5rem;
    }

    .item-list-left {
        display: flex;
        flex-direction: column;
        gap: 4px;
    }

    .results-count {
        color: #212529;
        /* Adjust this to match the heading color in your image */
        font-weight: 500;
    }

    .sort-section {
        display: flex;
        align-items: center;
        flex-direction: row;
        gap: 6px;
        max-width: 300px;
    }

    .sort-name {
        font-size: 13px;
        font-weight: 500;
        width: 100%;
        color: #242424;
    }

    .list-view-wrapper {
        display: flex;
        gap: 20px;
        align-items: flex-start;
    }

    .list-view-left {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 16px;
    }

    .list-view-right {
        width: 340px;
        flex-shrink: 0;
        position: sticky;
        top: 16px;
    }

    .ad-image {
        width: 100%;
        height: 384px;
        object-fit: cover;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }


    .pagination-container {
        margin-top: 24px;
    }
</style>