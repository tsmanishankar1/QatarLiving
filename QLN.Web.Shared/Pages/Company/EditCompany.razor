@page "/edit-company"
@inject ISnackbar Snackbar
@inject IJSRuntime JSRuntime

@using QLN.Web.Shared.Components.BreadCrumb
@using System.ComponentModel.DataAnnotations


<div style=" background-color: #F2F4F7; height: 100%;width:100%;padding: 24px;">
    <div Class=" mt-1 ml-10">
        <Breadcrumb Items="breadcrumbItems" />

    </div>

    <MudText Class="heading-style mt-2 ml-14">Contact Information</MudText>

    <MudForm @ref="_form" Model="@_model" Validation="true" Class="mt-6">
        <MudGrid GutterSize="3">
            <!-- Company Logo Upload -->
            <MudGrid GutterSize="3">
                <MudItem xs="12" sm="4">
                    <div Class="image-upload-container" Style="height: 100%; display: flex; justify-content: center;">
                        <div class="upload-wrapper">
                            <div class="upload-content-container">
                                <MudText Typo="Typo.subtitle2" Class="upload-title">Company Logo</MudText>

                                <label for="logo-upload" class="upload-box">
                                    @if (logoPreviewUrl != null)
                                    {
                                        <img src="@logoPreviewUrl" class="logo-preview" alt="Company logo preview" />
                                    }
                                    else
                                    {
                                        <div class="upload-container" style="text-align: center; cursor: pointer;">
                                            <img src="qlm-images/Upload.svg" alt="Upload" style="height: 48px; color: #FF7F38; fill: #FF7F38;" />
                                            <div style="margin-top: 8px; color: #FF7F38; font-size: 14px; font-weight: 500;">Upload Image</div>
                                        </div>
                                    }
                                </label>

                                <MudText Typo="Typo.caption" Class="upload-subtitle">Recommended size: 1920×1200 pixels</MudText>
                            </div>

                            <InputFile id="logo-upload" OnChange="HandleLogoUpload" accept="image/*" style="display: none;" />

                       
                        </div>
                    </div>
                </MudItem>


                <!-- Form Fields -->
                <MudItem xs="12" sm="8">
                    <MudStack Spacing="2">
                                                <div class="selector-wrapper">

                        <MudTextField
                            id="businessName"

                                      @bind-Value="_model.BusinessName"
                                      Immediate="true"
                                      Label="Business Name"
                                      For="@(() => _model.BusinessName)"
                                      Class="form-input no-underline"
                                      Required />
                                      </div>
                        <div class="selector-wrapper">

                            <MudSelect id="country"
                                       @bind-Value="_model.Country"
                                      Immediate="true"
                                      T="string" Label="Country" For="@(() => _model.Country)"
                                       Class="form-input no-underline"
                                       Required>
                                <MudSelectItem Value="@("Qatar")">Qatar</MudSelectItem>
                                <MudSelectItem Value="@("UAE")">UAE</MudSelectItem>
                            </MudSelect>
                        </div>
                        <div class ="selector-wrapper">

                            <MudSelect T="string" Label="City" For="@(() => _model.City)"
                                       Class="form-input no-underline"
                                       id="City"
                                       @bind-Value="_model.City"
                                       Immediate="true"
                                       Required>
                                <MudSelectItem Value="@("Doha")">Doha</MudSelectItem>
                                <MudSelectItem Value="@("Dubai")">Dubai</MudSelectItem>
                            </MudSelect>
                        </div>
                                                <div class="selector-wrapper">

                        <MudTextField Label="Branch’s Location"
                                          Class="form-input no-underline"
                                          @bind-Value="_model.BranchLocations"
                                      id="BranchLocations"
                                      Immediate="true"
                                      Adornment="Adornment.End"
                                      AdornmentIcon="@Icons.Material.Filled.LocationOn"
                                          />
                                      </div>
                                                              <div class="selector-wrapper">

                        <MudTextField Label="Phone Number" For="@(() => _model.PhoneNumber)"
                                          Class="form-input no-underline"
                                          Required
                                      id="PhoneNumber"
                                      @bind-Value="_model.PhoneNumber"
                                      Immediate="true"
                                      />
                                      </div>
                                                                                      <div class="selector-wrapper">

                        <MudTextField Label="WhatsApp Number"
                                      For="@(() => _model.WhatsAppNumber)"
                                      Class="form-input no-underline"
                                      id="WhatsAppNumber"
                                      @bind-Value="_model.WhatsAppNumber"
                                      Immediate="true"
                                      Required
                                      />
                                      </div>
                                                                                      <div class="selector-wrapper">

                        <MudTextField Label="Email" For="@(() => _model.Email)"
                                      Class="form-input no-underline"
                                      id="Email"
                                      @bind-Value="_model.Email"
                                      Immediate="true"
                                      Required />
                                      </div>
                                                                                      <div class="selector-wrapper">

                        <MudTextField Label="Website URL" Class="form-input no-underline"
                                      For="@(() => _model.WebsiteUrl)"
                                      id="WebsiteUrl"
                                      @bind-Value="_model.WebsiteUrl"
                                      Immediate="true"
                                      Required/>
                                      </div>

                                                <div class="selector-wrapper">
                        <MudTextField Label="Facebook URL" Class="form-input no-underline"
                                      For="@(() => _model.FacebookUrl)"
                                      id="FacebookUrl"
                                      @bind-Value="_model.FacebookUrl"
                                      Immediate="true"
                                          Required />
                                      </div>
                                                                                      <div class="selector-wrapper">

                        <MudTextField Label="Instagram URL" Class="form-input no-underline"
                                      For="@(() => _model.InstagramUrl)"
                                      id="InstagramUrl"
                                      @bind-Value="_model.InstagramUrl"
                                      Immediate="true"
                                          Required />
                                      </div>
                        <!-- Operating Hours -->
                        <MudItem xs="12" Style="width:472px">
                            <MudText Typo="Typo.subtitle1" Class="mb-2" Style="font-weight:600;">Operating Hours</MudText>

                            <div class="row-flex">
                                <MudTextField Class="grid-input no-underline" Label="Start Day" Placeholder="e.g. Sunday"
                                For="@(() => _model.StartDay)"
                                              id="StartDay"
                                              @bind-Value="_model.StartDay"
                                              Immediate="true"
                                              OpenTo="OpenTo.Day"
                                              DateFormat="dddd" 
                                              Adornment="Adornment.End"
                                              AdornmentIcon="@Icons.Material.Filled.CalendarToday" />
                                
                                <MudTextField Class="grid-input no-underline" Label="End Day" Placeholder="e.g. Thursday"
                                              For="@(() => _model.EndDay)"
                                              id="EndDay"
                                              @bind-Value="_model.EndDay"
                                              Immediate="true"
                                              OpenTo="OpenTo.Day"
                                              DateFormat="dddd"
                                              Adornment="Adornment.End"
                                              AdornmentIcon="@Icons.Material.Filled.CalendarToday" />
                            </div>

                            <div class="row-flex">
                                <MudTextField Class="grid-input no-underline" Label="Start Hour" Placeholder="e.g. 8:00 AM" For="@(() => _model.StartHour)"
                                              id="StartHour"
                                              @bind-Value="_model.StartHour"
                                              Immediate="true"
                                              AmPm="true"
                                              Adornment="Adornment.End"
                                              AdornmentIcon="@Icons.Material.Filled.AccessTime" />
                                <MudTextField Class="grid-input no-underline" Label="End Hour" Placeholder="e.g. 5:00 PM" For="@(() => _model.EndHour)"
                                              id="EndHour"
                                              @bind-Value="_model.EndHour"
                                              Immediate="true"
                                              AmPm="true"
                                              Adornment="Adornment.End"
                                              AdornmentIcon="@Icons.Material.Filled.AccessTime" />
                            </div>
                        </MudItem>


                        <!-- Company Profile -->
                        <MudItem xs="12">
                            <MudText Class="section-header">Company Profile</MudText>
                            <div class="selector-wrapper">
                                <MudSelect T="string"
                                    Label="Nature of Business"
                                           id="NatureOfBusiness"
                                           @bind-Value="_model.NatureOfBusiness"
                                           Immediate="true"
                                           Class="form-input no-underline"
                                           For="@(() => _model.NatureOfBusiness)" Required>
                                    <MudSelectItem Value="@("Retail")">Retail</MudSelectItem>
                                    <MudSelectItem Value="@("Wholesale")">Wholesale</MudSelectItem>
                                </MudSelect>
                            </div>
                            <div class="selector-wrapper">
                                <MudSelect T="string"
                                           id="CompanySize"
                                           @bind-Value="_model.CompanySize"
                                      Immediate="true"
                                           Label="Company Size" For="@(() => _model.CompanySize)"
                                           Class="form-input no-underline"
                                           Required>
                                    <MudSelectItem Value="@("1-10")">1-10</MudSelectItem>
                                    <MudSelectItem Value="@("11-50")">11-50</MudSelectItem>
                                    <MudSelectItem Value="@("51-200")">51-200</MudSelectItem>
                                </MudSelect>
                            </div>
                            <div class="selector-wrapper">
                                <MudSelect T="string"
                                           id="CompanyType"
                                      @bind-Value="_model.CompanyType"
                                      Immediate="true"
                                           Label="Company Type" For="@(() => _model.CompanyType)" Class="form-input no-underline"
                                           Required>
                                    <MudSelectItem Value="@("Private")">Private</MudSelectItem>
                                    <MudSelectItem Value="@("Public")">Public</MudSelectItem>
                                </MudSelect>
                            </div>
                            <div class="selector-wrapper">

                                <MudTextField id="UserDesignation"
                                              @bind-Value="_model.UserDesignation"
                                      Immediate="true"
                                              Class="form-input no-underline"
                                              Label="User Designation" For="@(() => _model.UserDesignation)" />

                            </div>
                                                                            <div class="selector-wrapper">

                            <MudTextField Class="form-input no-underline"
                                          id="BusinessDescription"
                                          @bind-Value="_model.BusinessDescription"
                                          Immediate="true" Label="Description" For="@(() => _model.BusinessDescription)" Lines="4"
                                          MaxLength="300" />

</div>

                        </MudItem>

                        <!-- License -->
                        <MudItem xs="12">
                            <MudText Class="section-header">License & Visibility</MudText>
                                                                            <div class="selector-wrapper">

                            <MudTextField T="string"
                                          Label="CR Number"
                                              Class="form-input no-underline"
                                          Adornment="Adornment.End"
                                          AdornmentIcon="@Icons.Material.Filled.Upload"
                                          OnAdornmentClick="TriggerFileUpload" />
                            <InputFile id="doc-upload" OnChange="HandleDocumentUpload" style="display: none;" />
                            </div>
                            <div class="input-caption mt-2">
                                Supported file formats: PDF, PNG, JPEG. Max: 10MB
                            </div>


                        </MudItem>

                    </MudStack>
                    <!-- Submit Button -->
                    <MudItem xs="12">
                        <MudButton Variant="Variant.Filled" OnClick="SubmitForm" Class="mt-4 px-8" Style="background-color: #F26D1E;color:white">
                            Save
                        </MudButton>

                    </MudItem>
                </MudItem>

            </MudGrid>
        </MudGrid>
    </MudForm>

</div>


<style>

    .input-caption {
        font-size: 0.75rem;
        color: #888;
        margin-top: 0.25rem;
    }

    .heading-style {
        font-family: 'Public Sans', sans-serif;
        font-weight: 600;
        font-size: 18px;
        line-height: 26px;
        letter-spacing: 0;
        vertical-align: middle;
        color: #00426D;
    }

    .section-header {
        font-weight: 600;
        font-size: 1.125rem;
        margin: 1.5rem 0 0.75rem 0;
        color: #333;
    }

    .image-upload-container {
        padding: 1rem;
    }

    .upload-wrapper {
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .upload-content-container {
        width: 240px;
        height: 282px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: space-between;
    }

    .upload-box {
        width: 240px;
        height: 240px;
        border: 2px dashed #A1A1A1;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        background-color: white;
    }

    .upload-title {
        color: #424242;
        text-align: center;
        margin-bottom: 8px;
    }

    .upload-subtitle {
        color: #9E9E9E;
        text-align: center;
        margin-top: 8px;
    }

    .upload-icon {
        color: #9E9E9E;
        font-size: 3rem;
    }

    .logo-preview {
        width: 100%;
        height: 100%;
        max-width: 100%; 
        max-height: 100%; 
        object-fit: fill;
        display: block;
    }

    .upload-actions {
        display: flex;
        gap: 1rem;
        margin-top: 1rem;
    }

    .action-button {
        min-width: 100px;
    }

    .selector-wrapper {
        width: 472px;
        margin-top: 14px;
        background-color: #FFFFFF;
        border-radius: 6px;
        padding: 10px;
        position: relative;
    }

   
    /* Target MudBlazor's error message container */
    .mud-input-helper-text {
        position: absolute;
        bottom: -30px; 
        left: 8px;
        color: red ;
        font-size: 0.75rem;
    }

    .form-input {
      
        
        justify-content:center;
    }

        .form-input input {
            padding-left:15px;
        }


        .form-input .mud-input-control {
            width: 100%;
        }
        /* Special rule for select inputs */
        .form-input.mud-select {
            min-width: 100% !important;
            width: 100% !important;
        }

        .form-input .mud-input-slot {
            border-bottom: none !important;
        }

        .form-input .mud-input-control {
            border-bottom: none !important;
        }

    .row-flex {
        display: flex;
        gap: 40px;
    }

    .grid-input {
        width: 180px !important;
        background-color: #FFFFFF;
        padding: 14px;
        margin-top: 10px;
    }

        .grid-input .mud-input-slot {
        border-bottom: none !important;
    }

        .grid-input .mud-input-control {
        border-bottom: none !important;
    }
    .no-underline .mud-input-underline::before,
    .no-underline .mud-input-underline::after {
        border-bottom: none !important;
    }
    .custom-icon-color .mud-input-adornment-end .mud-icon-root {
        color: #FF7F38 !important;
    }

</style>
